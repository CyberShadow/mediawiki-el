2010-06-23  Mark A. Hershberger  <mah@everybody.org>

	* mediawiki.el: Clean up byte compilation warnings.
	(mediawiki-make-url): Remove url-hexify-string in favor of
	mm-url-form-encode-xwfu.
	(mediawiki-get-edit-form-vars): Clean up and simplify permission
	checking.  Use (message) instead of error to make messages less
	confusing.
	(mediawiki-site-password): Typo meant we weren't really getting
	the password.
	(mediawiki-do-login): Check to make sure we actually have a form
	variable.
	(mediawiki-view-source): New variable to show when we're viewing
	source.
	(mediawiki-pop-buffer-hook): New hook.
	(mediawiki-pop-to-buffer): New functon to run hook on buffer.xo
	(mediawiki-get, mediawiki-goto-relative-page): Use hook.

2010-04-26  Mark A. Hershberger  <mah@everybody.org>

	* mediawiki.el (url-compat-retrieve): Add help function so this
	works with older versions of url.el like those found in Xemacs.
	(url-http-get): Use url-compat-retrieve.
	(url-http-post): Delete any nil parameters.  Use url-compat-retrieve.
	(url-http-response-post-process): Follow redirects.  Need to add a
	redirect limit.
	(mediawiki-make-url): Make the URL properly if there is no action parameter.
	(mediawiki-get-edit-form-vars): Refactor generic form-reading
	functionality to mediawiki-get-form-vars.
	(mediawiki-get-form-vars): New function.
	(mediawiki-do-login): Rewrite so that new MW token parameter is
	used for login.
	(mediawiki-page-at-point): Identify and qualify sub-pages.
	(mediawiki-mode): Remove any bindings that use C-h.
	(mediawiki-insert): Fix mediawiki-insert using adopted patch from Bug#563127

